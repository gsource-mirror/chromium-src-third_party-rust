From d643e0e6423651d2ff014e8769f966d66505fce6 Mon Sep 17 00:00:00 2001
From: Manish Goregaokar <manishearth@google.com>
Date: Tue, 16 Dec 2025 00:05:03 +0000
Subject: [PATCH 1/3] Correct sign in nudge_to_zoned_time

Uplift of https://github.com/boa-dev/temporal/pull/647

Change-Id: Icf703e2ae907a6a820b6b1141883ed9ab825874c
---
 .../src/builtins/compiled/duration/tests.rs   | 20 +++++++++++++++++++
 .../src/builtins/core/duration/normalized.rs  |  2 +-
 2 files changed, 21 insertions(+), 1 deletion(-)

diff --git a/third_party/rust/chromium_crates_io/vendor/temporal_rs-v0_1/src/builtins/compiled/duration/tests.rs b/third_party/rust/chromium_crates_io/vendor/temporal_rs-v0_1/src/builtins/compiled/duration/tests.rs
index 0b6acac85cb18..28cb0a4e5b27a 100644
--- a/third_party/rust/chromium_crates_io/vendor/temporal_rs-v0_1/src/builtins/compiled/duration/tests.rs
+++ b/third_party/rust/chromium_crates_io/vendor/temporal_rs-v0_1/src/builtins/compiled/duration/tests.rs
@@ -862,3 +862,23 @@ fn bubble_smallest_becomes_day() {
         "Expected rounding to fail, got {rounded:?}"
     );
 }
+
+#[test]
+fn round_zero_duration() {
+    // Tests that totalling the zero duration returns zero
+    let d0 = Duration::new(0, 0, 0, 0, 0, 0, 0, 0, 0, 0).unwrap();
+    let rounding_options = RoundingOptions {
+        largest_unit: Some(Unit::Day),
+        smallest_unit: Some(Unit::Hour),
+        ..Default::default()
+    };
+    let relative_to = ZonedDateTime::try_new(0, TimeZone::utc(), Calendar::default()).unwrap();
+    let rounded_duration = d0
+        .round(
+            rounding_options,
+            Some(RelativeTo::ZonedDateTime(relative_to)),
+        )
+        .unwrap();
+
+    assert_eq!(rounded_duration, d0);
+}
diff --git a/third_party/rust/chromium_crates_io/vendor/temporal_rs-v0_1/src/builtins/core/duration/normalized.rs b/third_party/rust/chromium_crates_io/vendor/temporal_rs-v0_1/src/builtins/core/duration/normalized.rs
index 26819f99d71de..78957de5868b8 100644
--- a/third_party/rust/chromium_crates_io/vendor/temporal_rs-v0_1/src/builtins/core/duration/normalized.rs
+++ b/third_party/rust/chromium_crates_io/vendor/temporal_rs-v0_1/src/builtins/core/duration/normalized.rs
@@ -749,7 +749,7 @@ impl InternalDurationRecord {
         let beyond_day_span = rounded_time.checked_add(day_span.negate().0)?;
         // 12. If TimeDurationSign(beyondDaySpan) ≠ -sign, then
         let (expanded, day_delta, rounded_time, nudge_ns) =
-            if beyond_day_span.sign() != sign.negate() {
+            if (beyond_day_span.sign() != sign.negate()) && sign != Sign::Zero {
                 // a. Let didRoundBeyondDay be true.
                 // b. Let dayDelta be sign.
                 // c. Set roundedTimeDuration to ? RoundTimeDurationToIncrement(beyondDaySpan, increment × unitLength, roundingMode).
-- 
2.52.0.239.gd5f0c6e74e-goog

